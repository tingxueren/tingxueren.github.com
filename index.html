
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Tingxueren's Blog</title>
	<meta name="author" content="tingxueren">

	
	<meta name="description" content="最近论文写完了，不安分的心总是静不下来，又开始了一轮新的折腾。最近忙活的事情乱七八糟的，主要有下面的几件事：安装Arch， 重新投奔Arch旗下；申请到了Windows Azure的试用帐号，尝试国内的云服务；加入了WCG计划，开挖ripple币，貌似挖了那么久还不够电费的。 安装Arch &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Tingxueren's Blog" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">Tingxueren's Blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="http://google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:tingxueren.github.io">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		<a class="google" href="https://plus.google.com/112617278058034597125?rel=author" title="Google+">Google+</a>
		
		
		<a class="twitter" href="http://twitter.com/tingxueren" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/tingxueren" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="http://google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:tingxueren.github.io">
	</form>
</nav>

</header>
	
		
<div id="banner" class="inner">
	<div class="container">
		<ul class="feed"></ul>
	</div>
	<small><a href="http://twitter.com/tingxueren">tingxueren</a> @ <a href="http://twitter.com">Twitter</a></small>
	<div class="loading">Loading...</div>
</div>
<script src="/javascripts/twitter.js"></script>
<script type="text/javascript">
	(function($){
		$('#banner').getTwitterFeed('tingxueren', 4, false);
	})(jQuery);
</script>

	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2014/01/01/zui-jin-zhe-teng-bi-ji/">
		
			最近折腾笔记</a>
	</h2>
	<div class="entry-content">
		<p>最近论文写完了，不安分的心总是静不下来，又开始了一轮新的折腾。最近忙活的事情乱七八糟的，主要有下面的几件事：安装Arch， 重新投奔Arch旗下；申请到了Windows Azure的试用帐号，尝试国内的云服务；加入了WCG计划，开挖ripple币，貌似挖了那么久还不够电费的。</p>

<h2>安装Arch</h2>

<p>Arch是一个很优秀的发行版，哲学就是KISS，一切都遵循着最大的定制化的准则，像搭积木似的可以搭建出自己满意的一个实用的系统。和我常用的ubuntu不同的是不提供一个开箱即用的桌面环境，一切都要自己来搭建。Arch的包管理是很激进的，向来追求最新的软件，而不太考虑软件的稳定性，而且是滚动发行的版本，不是像有些发行版那样有个稳定的开发周期，如果系统关键部件调整而没有按照wiki的方法做好调整就升级的话常常造成系统损坏无法开机的悲剧。</p>

<p>曾经使用过Arch四个月，大概是2012.04-2012.07,当时的安装有一个自动化的脚本，安装起来比较简单，使用起来还好，就是笔记本无法正常的休眠和唤醒，这个比较头大，一直没有解决。最后在有一次升级的时候没有注意一些警告强行升级导致了GRUB的引导出错了，Windows 7和Arch 都找不到了，当时也用Arch烦就彻底的删除了Arch，装回了ubuntu了，还是它省心。最近ubuntu越来越慢，很臃肿，用时间长了又想尝试新的东西，加上笔记本的分区很不合理，C盘只有500M的剩余空间了，索性全部格掉重新安装成 Windows 7 + Arch 双系统。Widonws的安装没什么可说的，Arch的安装倒是有些需要注意的地方，Arch的wiki是很好的资料，基本上所有的操作都是参照着wiki的介绍。</p>

<h3>分区</h3>

<p>本次使用的安装介质是archlinux-2013.12.01-dual.iso，使用dd命令烧录到了u盘中安装的。从u盘启动后进入了Arch的live cd模式，第一步就是分区，因为是双系统，Windows已经安装好了，需要多重引导，分区方面需要特别的留意，双系统引导最好使用MBR引导，使用了cfdisk的分区工具，这个工具很直观，比fdisk好用。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> Name                   Flags                Part Type           FS Type                        [Label]                    Size (MB)
</span><span class='line'>-----------------------------------------------------------------------------------------------------------------------------------------------
</span><span class='line'>                                              Primary            Free Space                                                     2.10           *
</span><span class='line'> sda1                   Boot                  Primary            ntfs                           [Windows-7]                 85901.45           *
</span><span class='line'> sda5                   NC                    Logical            ntfs                           [D-Disk]                    85899.35           *
</span><span class='line'> sda6                   NC                    Logical            ntfs                           [E-Disk]                    85899.35           *
</span><span class='line'> sda7                                         Logical            swap                                                        4096.19           *
</span><span class='line'> sda8                   Boot                  Logical            ext4                                                       20480.95           *
</span><span class='line'> sda9                                         Logical            ext4                                                       37793.57           *</span></code></pre></td></tr></table></div></figure>


<p>sda8挂载在<code>/</code>上，sda9挂载在<code>/home</code>上，注意要将挂载到根的分区设置为可引导的。然后格式化各个分区，并挂载swap。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># 根据自己的实际情况进行修改
</span><span class='line'>mkfs.ext4 /dev/sda8    
</span><span class='line'>mkfs.ext4 /dev/sda9
</span><span class='line'>mkswap /dev/sda7 
</span><span class='line'>swapon /dev/sda7</span></code></pre></td></tr></table></div></figure>


<h3>安装基本系统</h3>

<p>这部分基本上按照wiki的操作就可以了：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># 挂载分区
</span><span class='line'>mkdir /mnt/home
</span><span class='line'>mount /dev/sda8 /mnt
</span><span class='line'>mount /dev/sda9 /mnt/home</span></code></pre></td></tr></table></div></figure>


<p>设置网络和安装源，这点不同人的情况不同，要按照自己的实际情况进行设置</p>

<p>安装基本系统</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#pacstrap /mnt base base-devel
</span><span class='line'>Generate an fstab
</span><span class='line'># genfstab -U -p /mnt &gt;&gt; /mnt/etc/fstab
</span><span class='line'># nano /mnt/etc/fstab</span></code></pre></td></tr></table></div></figure>


<p>chroot 并配置基本的系统</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># 使用bash
</span><span class='line'># arch-chroot /mnt /bin/bash
</span><span class='line'># 设置hostname
</span><span class='line'># echo myhostname &gt; /etc/hostname
</span><span class='line'># 设置时区
</span><span class='line'># ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</span><span class='line'># 设置locale
</span><span class='line'># nano /etc/locale.gen
</span><span class='line'>en_US.UTF-8 UTF-8
</span><span class='line'>zh_CN.UTF-8 UTF-8
</span><span class='line'># locale-gen
</span><span class='line'># 设置硬件时钟为UTC
</span><span class='line'># hwclock --systohc --utc
</span><span class='line'># 设置网络，启用dhcpcd
</span><span class='line'># systemctl enable dhcpcd.service
</span><span class='line'># 设置无线网络
</span><span class='line'># pacman -S iw wpa_supplicant
</span><span class='line'># Make initramfs (RAM Disk) 
</span><span class='line'># mkinitcpio -p linux
</span><span class='line'># 设置 root 密码
</span><span class='line'># passwd
</span><span class='line'># 安装GRUB引导，现在GRUB有bug，这个bug导致了我尝试了5遍都没有正常的引导起来
</span><span class='line'># 解决方案很简单，具体参见这个[网页](https://bugs.archlinux.org/task/38041?project=1&cat%5B0%5D=31&string=grub)
</span><span class='line'>Known issue with known workaround: add the following to /etc/default/grub
</span><span class='line'># fix broken grub.cfg gen
</span><span class='line'>GRUB_DISABLE_SUBMENU=y
</span><span class='line'># 双系统引导还需要附加软件
</span><span class='line'># pacman -S os-prober
</span><span class='line'># grub-mkconfig -o /boot/grub/grub.cfg
</span><span class='line'># grub-install /dev/sda
</span><span class='line'># 退出chroot，卸载磁盘，然后重启
</span><span class='line'># exit
</span><span class='line'># umount -R /mnt
</span><span class='line'># reboot
</span></code></pre></td></tr></table></div></figure>


<h3>安装gnome3桌面</h3>

<p>一直用着gnome3的桌面，虽然说KDE桌面更漂亮，也用了一段时间，但是依然不习惯，gnome3看来更符合我的口味。Arch中安装起来也很简单，继续copy wiki：</p>

<h4>安装X</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># 基本X组件
</span><span class='line'># pacman -S xorg-server xorg-server-utils xorg-xinit
</span><span class='line'>Install mesa for 3D support:
</span><span class='line'># pacman -S mesa
</span><span class='line'># 安装显卡驱动,我的是Nvidia
</span><span class='line'># pacman -S nvidia
</span><span class='line'># 触摸板驱动
</span><span class='line'># pacman -S xf86-input-synaptics
</span><span class='line'># 测试X系统
</span><span class='line'># pacman -S xorg-twm xorg-xclock xterm
</span><span class='line'># 应该能看到图形界面了
</span><span class='line'># startx
</span><span class='line'># exit</span></code></pre></td></tr></table></div></figure>


<h4>安装gnome3</h4>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># pacman -S gnome gnome-extra gdm
</span><span class='line'># 开机启动gdm，不使用startx
</span><span class='line'># systemctl enable gdm
</span><span class='line'># 建立常用的用户
</span><span class='line'># useradd -G wheel -m -s /bin/bash user_name
</span><span class='line'># passwd user_name
</span><span class='line'># usermod -G adm -a  user_name</span></code></pre></td></tr></table></div></figure>


<h4>字体与输入法</h4>

<p>Arch默认的字体配置是惨不忍睹的，gnome绑定的ibus输入法也不怎么样，准备都要重新调整，换成自己常用的，准备安装的输入法是fcitx，字体配置方案向ubuntu看齐，感觉ubuntu的字体配置相当的不错。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># pacman -S fcitx-im fcitx-config
</span><span class='line'># 在~/.xprofile和~/.xinitrc中加入下面三行
</span><span class='line'> export GTK_IM_MODULE=fcitx
</span><span class='line'> export QT_IM_MODULE=fcitx
</span><span class='line'> export XMODIFIERS="@im=fcitx"
</span><span class='line'># 重新登录应该就能用了
</span><span class='line'># 推荐sunpinyin
</span><span class='line'># pacman -S fcitx-sunpinyin</span></code></pre></td></tr></table></div></figure>


<p>字体的配置可以参考<a href="http://blog.chinaunix.net/uid-25906175-id-3072940.html">Archlinux 字体配置</a>。</p>

<h3>杂项</h3>

<p>双系统设置时钟的问题，参考<a href="http://webdancer.is-programmer.com/posts/29553.html">archlinux入门&mdash;设置时钟</a>。</p>

<p>使用octopress的问题，参考<a href="http://shadow.ma/blog/2013/04/07/octopress-on-arch-linux/">Octopress 在 Arch Linux 下的一些問題</a>。</p>

<h2>Windows Azure</h2>

<p>Windows Azure是微软家的云服务，由于天朝的特殊环境，分成了国际版和中国版，我试用的是中国版，由世纪互联公司运营。还是蛮幸运的，在v2ex上看到了可以免费试用的消息就填了个邮箱，写了个申请，就很快的得到了试用的机会。</p>

<p>试用的配置还是很不错的，最多可以用4个核心，磁盘空间上面Windows虚拟机有120+G的C盘，还有100+G的D盘，据说是临时的盘，但是我没有发现什么区别，Linux的磁盘空间少了点，<code>/</code>有29G，<code>/mnt</code>有135G，为NTFS的盘。我在上面建立了一个ubuntu 12.04的虚拟机和一个Windows Server 2012虚拟机，正好把cpu分配的额度用完。</p>

<p>Windows的服务器是使用远程桌面登录的，Linux可以正常的使用ssh登录管理。Azure自带的有防火墙，上面可以指定相应的端口的策略，看文档上写的暂时不支持iptables的设置，所以Linux的机器上就没有开防火墙，只是在管理界面上开了必要的端口。管理界面是比较清爽的，看起来很错，但是不清楚如何通过web直接访问机器，比如防火墙配置错误，无法ssh登录了，或者ssh挂掉了如何修复。管理界面上只有关闭、重启等寥寥几个选项，不知道遇到这种情况怎么办，是不是只有重装了，原来的数据又怎么办？</p>

<p>Windows Azure的虚拟机的带宽还是不错的，虽然不能和国外的VPS的100M或者1G的带宽相比，但是至少不差。据说是共享的带宽，在服务器中下载速度能达到5MB/s，出口带宽感觉也能达到4M。还有点不爽的是服务器禁止ping，无法在服务器内部使用ping，在外面也无法ping通服务器，有一个替代的方式是使用tcpping，Windows下的具体的使用方法可以参见这篇<a href="http://blog.sharepointsaigon.com/2012/12/ping-azure-vm.html">文章</a>, Linux的使用方法<a href="http://xmodulo.com/2013/01/how-to-install-tcpping-on-linux.html">在此</a>。</p>

<p>由于blog架设在Digitalocean上了，科学上网的服务也无法在国内服务器上部署，因此Windows Azure的服务器在我的手上基本上在浪费，只用来当个迅雷下载工具了，学校最近封锁了迅雷，还限制了网速，有个不限速的服务器用着也很爽。</p>

<h2>ripple矿工</h2>

<p>下介绍下WCG，因为XRP是通过在WCG上做贡献才能换到的。下面是WCG的官方介绍：</p>

<p>我们的任务、工作以及志愿者
World Community Grid 的任务是创建世界上最大的公共计算网格，以执行能够造福人类的项目。</p>

<p>我们已经开发了技术基础结构，该结构可作为用于科学研究的网格的基础。我们的成功依靠大家共同贡献各自空闲的计算机时间，让世界变得更美好。</p>

<p>World Community Grid 仅将这项技术用于公共非盈利组织的人道主义研究，如果没有公共网格，这些研究就会因高昂的计算机基础结构成本而无法完成。作为我们对促进人类福祉的承诺，所有的研究结果都将公开，以供全球的研究团体共享。</p>

<p>至于ripple是什么就不介绍了，想知道干什么的，请google。</p>

<p>首先去WCG官网注册个帐号，官网<a href="https://secure.worldcommunitygrid.org/index.jsp">在此</a>，然后你需要关联你的ripple帐号与WCG帐号，这样你在WCG上做的贡献才能获得ripple官方的奖励，关联的网站<a href="http://www.computingforgood.org/">在此</a>。</p>

<p>在网站下载<a href="https://secure.worldcommunitygrid.org/reg/ms/viewDownloadAgain.do">WCG软件</a>，Windows下和Linux下的图形界面基本类似，Linux下的字符界面的操作略有不同，下面简要介绍下步骤。</p>

<p>全命令行进行挖矿教程如下：
最好用包管理器安装boinc相关软件，Ubuntu、Debain系统安装命令：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo apt-get install boinc-client boinc-manager
</span><span class='line'>
</span><span class='line'>安装完成之后boinc-client已经启动，现只需运行wcg项目，命令如下
</span><span class='line'>sudo boinccmd --project_attach http://www.worldcommunitygrid.org/ 弱账户密钥
</span><span class='line'>
</span><span class='line'>其中弱账户密钥在 https://secure.worldcommunitygrid.org/ “setting” -&gt; “我的概要文件”
</span><span class='line'>
</span><span class='line'>关于BOINC客户端的命令详情参考：http://www.equn.com/wiki/Boinccmd</span></code></pre></td></tr></table></div></figure>


<p>关于收益，貌似比较少，最近的行情是300个贡献点数能换1个XRP，1个XRP成交价大概是0.16RMB左右。一般一天一台普通的电脑的贡献点数是5000点左右，不到3块钱，不过聊胜于无，也算是为世界做出点贡献，毕竟计算机闲着也是闲着。</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2014-01-01T12:43:00+08:00" pubdate data-updated="true">Jan 1<span>st</span>, 2014</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/10/22/bai-du-yun-wei-mian-shi-quan-ji-lu/">
		
			百度运维面试全记录</a>
	</h2>
	<div class="entry-content">
		<p>今天终于功德圆满了，上午和百度的 HR 谈了会，因为三方还没到，就和百度签了 2 方，也算是给自己一个交代。基本上结果还是满意的，能去做自己想做的东西本身就是一种幸福，回想起来这几天的笔试面试，心情像过山车似的上下起伏，有兴奋，有紧张，有焦虑，有欣喜。一段经历往往就是这么令人印象深刻。</p>

<h2>2013.10.13 百度笔试</h2>

<p>在参加笔试前还是没有信心的，可能阿里给我的打击比较严重。当时的岗位貌似还投的有问题，开始的时候不知道自己到底想要做什么投的职位是研发工程师，但是后来发现更喜欢做运维，临时的改成了运维。百度还是比较有气度的，欢迎霸笔，欢迎霸面，只要你有实力，就有你展现实力的舞台，临时改职位就相当与霸笔了。题目还是有一定的水准的，比较均衡，自己尽了最大的努力做，当时的感觉是如果不给面试机会的话也不会后悔。</p>

<h2>2013.10.14 百度一面</h2>

<p>十分幸运的是昨晚10点多接到了面试的通知，第二天早上 9:30 面试。是在一个酒店里面面试的，很奇怪的是没有 HR， 前台也没有任何的接待人员，每个人都是到各个面试官的房间里面去面试的。</p>

<p>我大概在 9:20 多去房间面试的，面试官是个很和蔼的，微微有点胖的人，很年轻，感觉和我差不多大。没有自我介绍之类的，开始的时候聊聊笔试的程序设计的题目，题目说的是在长距离的传输中明明带宽很大，但是传输速度却很慢的问题。我首先回答了我的理由：</p>

<p>1.路由设置有问题，可能分配到了很拥堵的线路，造成的传输很慢；</p>

<p>2.发送的时候包分的过大，导致有些中间的路由节点会分片，然后到了接受端再进行数据的合并，会造成很大的损失。</p>

<p>面试官友好的和我讨论了这些东西，他说我说的这些理由都对，但不是影响传输速度最大的因素。还给了提示，汽车在高速上开的很快，但是在城市中就开的很慢，这是为什么？ 但是我确实没想清楚这问题应该怎么去回答。然后他给了一个他认为的原因，因为路径太长，在一路上会有很多的节点进行数据的转发或者是信号增强之类的，信号从线路上到进入节点的cpu中进行处理，速度就会降低，节点越多速度下降的越多，虽然他是这么解释的的，但是我感觉我还是无法赞同他的观点。</p>

<p>然后是下一步的考察些基本的 linux 命令什么的，<code>ls, ls -al</code> 等等， <code>vi</code> 中的替换命令，还让我替换掉一个 c 程序中的一个写错的变量名，我感觉这个可以用 <code>sed</code>，还需要用正则表达式来匹配避免误伤，但是当时正则表达式好像没有写出来。我说还用过 <code>vsftp</code> 搭建过 <code>ftp</code> 服务，他就问了下，<code>ftp</code> 的验证方式有那几种？我不太清楚，只回答了匿名的帐号，和系统帐号，其实还有手动的验证的，将用户名和密码分别写在不同的文件中进行验证，原始的数据库形式的，还有一种就是需要有 <code>mysql</code> 的数据库的支持了，基本上就是这些验证方式了。</p>

<p>在我的简历上还写了编写 shell 脚本分析日志，然后他就让我举个例子，我就说对 <code>apache</code> 的日志进行切割找出访问量最大的ip出来，貌似我当时些的是这个样子的，<code>cat log | awk ‘{print $1}‘| sort| uniq -c | sort -nr</code> ，然后他问了不用 <code>cat</code> 怎么办？我写成了这个样子，<code>awk ‘{print $1}’ &lt; log | sort | uniq -c | sort -nr</code> , 然后问还有没有什么办法，我说用 <code>less，more</code> 都可以吧，其实可以直接写成 <code>awk ‘{print $1}’  log | sort|uniq -c | sort -nr</code>, 这样感觉更好看一些，但是当时没想到。</p>

<p>最后还考了点 IO 重定向的问题。比如 <code>2&gt;1</code> 什么意思，我说基本没见过这么写的，我见过的是 <code>2&gt;&amp;1</code>, 错误输出也输入到标准输出里面去，不知道对不对。然后他写了两个看起来比较容易混淆的命令 <code>2&gt;&amp;1 &gt;log</code>  和 <code>&gt;log 2&gt;&amp;1</code> 有什么区别，我说第一种应该是错误的输出也重新定向到了 <code>log</code> 了，第二种应该是错误的输出没有定向到 <code>log</code> 中，回来实验了下，貌似恰好回答反了，看了记忆是不靠谱的。最后大概还问了平时在公司如何管理那么多台的服务器，用些什么工具进行管理，是自己写的工具还是别人做的？ 可能我面试的时间长了, 为了不耽误下一个同学的面试, 他只是很简要的敷衍的和我说了句: &ldquo;你以后来公司就知道了&#8221;。希望如他所愿。</p>

<p>一面的感觉还好，感觉应该有希望进入二面的，回来就慢慢的期待二面点电话通知了。</p>

<h2>2013.10.15 百度二面</h2>

<p>大概和一面的情况差不多，也是10点多接到二面的，第二天进行二面。二面开始的时候简单的自我介绍了下了，发现这就是个引入话题的方式，当我介绍到在实验室搭建了 <code>nfs</code> 服务的时候，他貌似很感兴趣，开始让我画一下 <code>nfs</code> 的架构，当时有点蒙，不是很清楚这个到底是个什么样子的，只是简单的画了下， 有个 <code>nfsd</code> 的服务，貌似还有个控制端口的服务什么的。然后就开始对这这个 <code>nfs</code> 的架构进行发问了，你感觉 <code>nfs</code> 有什么缺点，我说这个不怎么了解，但是发现如果服务端挂掉后，客户端是无法正常的卸载掉挂载的数据的，其实还有很多的缺点，回来后上网查找了下。</p>

<p>然后问，有机器 0～4, 0 为 <code>nfs</code> 服务器，1～4 挂载着 0 共享出来的文件，现在机器 0 down 掉了，问用 <code>wget</code> 可以从 4 中取出共享的文件吗？我说是不可以的，因为文件只有一份，服务器挂掉后就挂掉了，问我有什么解决方案没有，我说既然这个单机的不靠谱，就直接上 <code>hadoop</code> 吧，至少这样会保证数据安全，冗余度高。然后简单的画了下 <code>hadoop</code> 的架构图，然后和他扯了 <code>hdfs</code> 的基本原理和它存储的策略。在说到数据是按照 64M 一块来存储的时候，他问了下你知道 <code>linux</code> 的文件系统一般是多大的一块的吗？我说是 4K，他就问为什么 <code>hadoop</code> 要用 64M 这么大的块做存储，我说原因主要是考虑到效率问题，<code>hadoop</code> 是主要处理大数据的，将数据块分的大一点，系统一下就可以预读很多的东西，太大的块会造成浪费，太小的块会造成系统的效率低下。系统采用 4K 的块主要是为了避免浪费，因为文件即使没有占用一个块，那么这个块中的其他的空间也无法利用了。4k 主要是避免小文件造成的损失，从这里开始问到了文件系统，我大致的把文件系统的结构图画了出来，超级块，组的描述块，块占用的位图描述，<code>inode</code>的占用描述，<code>inode</code>节点，数据块。</p>

<p>然后说用 <code>vi</code> 打开个文件，然后删除，再保存会有什么情况，我说原来的文件还是会回来的，因为在删除的时候只是把文件名与具体的 <code>inode</code> 节点脱钩，原来的 <code>vi</code> 打开的是以 <code>inode</code> 作为标识符的，文件名字无所谓，随便删除，保存后会生成新的文件名与 <code>inode</code> 的对应关系。然后的问题是 <code>vfs</code> 的东西，虚拟文件系统，他说 <code>linux</code> 支持很多的文件系统，但是这些文件系统很不一样，但是用户操作起来却是一样的这个是什么原因，我说是因为 <code>linux</code> 实现了虚拟的文件系统，这个 <code>vfs</code> 屏蔽了下层的各种文件系统的差别，对上层的应用提供了一个统一的接口，所以说用户感觉操作起来的习惯是一致的。然后问了下 <code>/proc</code> 文件夹是干嘛的，我说里面是各个进程的数据，有占用cpu，内存，打开的文件，程序的文件夹等等信息，然后问这个是不是也是通过 <code>vfs</code> 进行读取的，我的回答是是的。</p>

<p>然后开始问了点命令，如何查看当前的网络状况，流量什么的，我说可以使用 <code>iftop</code> , 他说还有没有别的方案，我说可以监控 <code>ifconfig</code> ，每秒刷新一次，具体用什么命令我是忘记了, 回来查询了下用 <code>watch ifconfig</code> 即可。然后问怎么查看网络各个端口状况，我回答用 <code>netstat</code> ，他说有什么问题没有？ 我说有，感觉就是太慢了，他问我有什么改进方案，没想出来， <code>netstat</code> 就是从 <code>/proc</code> 里面读取的数据，还有什么特别的解决方案。然后我问他有什么办法，他说了下，说是有个 <code>ss</code> 的命令，貌似很牛逼，说是速度很快，我记下了，回来查查看，确实牛逼，当时还用过过，但是就是没有什么印象，太他妈的坑爹了。</p>

<p>问完了这个貌似又有个问题，在多进程或多线程的时候同时处理一个 url，如果有 url 过来了，在阻塞状态的进程或线程会同时醒来响应，造成了竞争，问我有什么方案？我想了想说主要是这些进程同时响应了，可以指定一个进程处理 url，其他的不响应，我想的方案是下面的三种，最后面试官告诉我这个是“惊群”现象，回去可以查查。</p>

<ol>
<li>设置一个空闲进程队列，每个空闲的进程入队，来一个 url，队首的进程进行处理，其他的不动。</li>
<li>根据 url 的 ip 来划分，指定这些进程只响应指定 ip 段的请求。</li>
<li>可以对 url 做 hash，然后分配到不同的进程中去工作。</li>
</ol>


<p>下面是写程序的阶段，一个是求 m 个数中的前 k 最大值，这个是《剑指 offer》 上面的原题。我用 c 写的，悲剧的是很久没在纸上写代码，感觉在纸上写代码就是很诡异的感觉，一点都不习惯。先讲述了下思路，利用了快排的一个阶段，求 partition 的阶段，这个就是将原来的数组分成了 2 个部分的，遗憾的是老是想不清楚，代码写的很烂，还没写完。虽然思路对了，但是就是很烂。下一个是要写个小脚本，a，b两个文件，将a，b中的行做交叉，这个他妈的我写过的，但是当时写出来还是很烂，感觉都要崩溃的感觉。下面是回来写的代码，虽然还是很烂，但是能工作了。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/bash
</span><span class='line'># 读入两个文件，逐行读入，并交替打印出来
</span><span class='line'>
</span><span class='line'>testfile1=$1
</span><span class='line'>x1=`wc -l $testfile1 |awk '{print $1}'`
</span><span class='line'>testfile2=$2
</span><span class='line'>x2=`wc -l $testfile2 |awk '{print $1}'`
</span><span class='line'>
</span><span class='line'>if [ $x1 -le $x2 ]; then
</span><span class='line'>  x=$x1
</span><span class='line'>elif [ $x2 -lt $x1 ]; then
</span><span class='line'>  x=$x2
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'>i=1
</span><span class='line'>while [ $i -le $x ]
</span><span class='line'>do
</span><span class='line'>    echo "`head -$i  $testfile1 | tail -1`"
</span><span class='line'>    echo "`head -$i  $testfile2 | tail -1`"
</span><span class='line'>    i=`expr $i + 1`
</span><span class='line'>done
</span><span class='line'>
</span><span class='line'>if [ $x1 -gt $x2 ]; then
</span><span class='line'>  i=`expr $x2 + 1`
</span><span class='line'>  while [ $i -le $x1 ]
</span><span class='line'>  do
</span><span class='line'>      echo "`head -$i  $testfile1 | tail -1`"
</span><span class='line'>      i=`expr $i + 1`
</span><span class='line'>  done
</span><span class='line'>fi
</span><span class='line'>
</span><span class='line'>if [ $x2 -gt $x1 ]; then
</span><span class='line'>  i=`expr $x1 + 1`
</span><span class='line'>  while [ $i -le $x2 ]
</span><span class='line'>  do
</span><span class='line'>      echo "`head -$i  $testfile2 | tail -1`"
</span><span class='line'>      i=`expr $i + 1`
</span><span class='line'>  done
</span><span class='line'>fi
</span></code></pre></td></tr></table></div></figure>


<p>再然后就是随便聊聊项目，将项目扯蛋了一遍，然后问了和一面同样的问题，这次面试官给了个正面回答，总的来讲运维管理是个很复杂的系统。主要侧重于应用的维护，而不在于一个个机器的管理，更底层的机器管理的工作一般都包给了机房让机房去做了，他们只要管理好在上面跑的应用就好，做负载均衡，机器优化，性能调优等等，对各种突发情况的处理，做处理的预案等等。感觉二面的感觉不是很好，但是内心感觉应该还是有点机会的。</p>

<h2>2013.10.16-17 煎熬</h2>

<p>按照以前的节奏，应该 16 号就应该三面了，但是二面回来后彻底的没有消息，看这周围的同学有些就去三面了，当时心里十分的纠结，怀着希望，又带着绝望。在 17 号终于决定不去想这档子事情了，去市区，准备去霸面华为，心情十分的低落。华为不给机会，折腾到了 3 点还没有吃到午饭，好不容易找到了个店刚点好菜，百度的电话到了，让我明天去三面。当时的心情无法形容，感觉有点泪流满面的感觉。</p>

<h2>2013.10.18 百度三面</h2>

<p>三面是 boss 面，感觉还是不错的，就是随便谈谈。基本上不聊技术，聊人生，聊规划，这时的重点不在于技术，而在于人了。就是 boss 考察你这个人，适合不适合他的团队，每个人的经历各有不同，展现自己的真实的一面就好。</p>

<h2>2013.10.19-21 纠结</h2>

<p>面试完了，剩下的时间就是纠结了。毕竟很在乎这份工作，加上手里没什么 offer，表现的对这份工作特别的渴望，在 19 号有人收到 offer 后，感觉常常的否定自己，忐忑不安的感觉。这样折磨了 3 天后 21 晚上终于接到了 HR 的电话，尘埃落定了。</p>

<h2>后续</h2>

<p>帝都，我来了！！！</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-10-22T20:22:00+08:00" pubdate data-updated="true">Oct 22<span>nd</span>, 2013</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/10/22/zhao-gong-zuo-jie-shu-liao/">
		
			找工作结束了</a>
	</h2>
	<div class="entry-content">
		<p>转眼 blog 又快四个月没有更新了，一方面原因是因为懒惰，另一方面原因是确实很忙感觉写个 blog 都没心情了。其实这几个月也发生了很多事情，blog 所用的 vps 也由yardvps 迁移到了 DigitalOcean, blog 的架构也由 LAMP 换成了 LNAMP， 其实就是瞎折腾。 不得不说 Digitalocean 的线路确实要比 yardvps 的线路强的多了，原来的半价买的 yardvps 平均来说一个月要抽风个一周，实在是烦了，转移到了 Digitalocean, 确实很不错，操作方便，也够便宜，最重要的是网络很稳定，不得不赞一个。</p>

<p>从7月到10月基本上都是找工作的节奏，到今天终于结束了，终于签了一个还比较满意的公司，准备去做我喜欢做的东西了，感觉很开心！以后就投入度娘的怀抱了，百度的平台还是不错的，希望以后有更好的发展。</p>

<h2>基本情况</h2>

<p>本科数学专业，非名校计算机小硕</p>

<p>未接受完整的计算机基础教育</p>

<p>对 Linux 比较熟悉，喜欢折腾点东西</p>

<p>算法功底比较薄弱</p>

<p>编程语言只用过 c/c++，shell，python, 且谈不上精通</p>

<p>基本无实际工程项目经验</p>

<p>研究生阶段做的东西偏学术</p>

<h2>求职意向</h2>

<p>互联网公司运维或系统工程师</p>

<p>主要理由：</p>

<ol>
<li><p>我看好服务端的发展，随着互联网的发展，传统的桌面软件势微，现在更多的是使用 web 和移动 App，但是孱弱的 web 和 App 无法承受用户对数据和资源的需求，更多的请求被压在了服务端，Web 和 App 的繁荣也意味着服务端的繁荣。做服务端，后台方面的工作是很有前途的。</p></li>
<li><p>自己的爱好兴趣吧，感觉自己挺喜欢折腾这些系统服务器什么的，管理这些机器正常的工作有点像牧羊人看着自己的羊羔都慢慢长大的那种喜悦的感觉。</p></li>
<li><p>感觉自己的知识结构基本上还是符合做这份工作的基本要求的。</p></li>
</ol>


<h2>准备情况</h2>

<p>基本上从7月份开始准备，从基本的 c/c++ 语法看起，虽然说都用过，但是都没有特别深入的了解，有些语言特性也是是是而非的，必须要过一遍，要不大部分的笔试基础题目是不会做的，当时主要是把《c 程序设计语言》和 《c++ primer》重新看了下。然后就是算法的准备了，感觉算法可能是我最弱的一方面，没有经过严格系统的训练就是搞不懂这些玩意，记得看的书也很杂乱无章，《数据结构》，《c 算法》之类的，但是看的不是很系统。最后是些常考的笔试题目，主要把《剑指 offer》和《编程之美》看了看，《剑指 offer》感觉挺好的，里面都有所有解决方案的源代码，还有测试用例，可以学习下比较严谨的代码风格。《编程之美》主要是些数学题目，可以开阔下眼界，拓展下思路。</p>

<h2>求职过程</h2>

<h3>阿里巴巴实习面试</h3>

<p>2013.05.04 应聘阿里巴巴系统工程师实习生</p>

<p>人生中第一次的电话面试，电话面试表现的还好，但是到了淘宝进行 boss 面的时候，缺乏面试经验的缺点暴露无疑，面试了总共不到半小时就结束了，实习计划破灭。</p>

<h3>华为</h3>

<p>2013.08.04 华为机试</p>

<p>2013.08.07 华为座谈</p>

<p>2013.09.01 华为性格测试</p>

<p>测试后我的华为应聘历程到此结束了，性格测试未通过，然后后面就没有机会了。</p>

<h3>阿里巴巴</h3>

<p>2013.08.30 参加了阿里大讲堂活动，去听了个关于搜索的讲座。感觉还是不错的，听到了很多以前不了解的技术，中午混了块披萨，下午答对了一道题目还拿了本书回来，具体的题目是：“当你在淘宝上搜索一个关键字的时候，后台大概有多少的数据参与了运算？”， 我当时蒙了个 1TB，实际的答案是 1.4TB， 我的最接近。实在没想到，一个小小的搜索背后竟然需要这么海量的数据的支撑。</p>

<p>2013.09.22 阿里巴巴笔试</p>

<p>选择的岗位是系统工程师，貌似杭州的卷子的风格和历年的题目和其他地区的题目都有点差别。更偏重于计算机基础，组成原理方面的知识。附加题还有数据库方面的知识，当时感觉做的很糟糕，但是幸运的是还是有面试的机会。</p>

<p>2013.09.24 阿里巴巴一面</p>

<p>一面的时候是个很年轻的帅哥，见面也不需要什么自我介绍。看着简历聊聊天，貌似对我的 blog 和我以前帮朋友维护的网站都很有兴趣，边看我的 blog，边和我讨论些问题。貌似当时还问了我虚拟机的具体架构，虚拟机如何与宿主机通信等问题，这些问题确实一点都不了解，当时都快跪了，幸好面试官感觉我对这些操作还是很熟悉，而且很有热情做这项工作，给了我二面的机会，还给我我一夜的时间去准备二面，十分感谢他。</p>

<p>2013.09.25 阿里巴巴二面</p>

<p>二面的情况是从头跪到了尾，一方面自己确实没有什么工程项目的经验。另一方面当时面试的时候太紧张，最重要的确实准备不足够，前期的时候准备的更偏重于开发方面的东西，对系统、网络方面的知识没有认真的复习，记得面试官问我相当简单的 TCP 协议中的 Time_Wait 状态是什么的时候，脑子中一片浆糊，没有回答出来。二面不出意料的挂掉了，但是我也学到了不少东西，也更坚定了以后做运维的决心，回去收拾心情，看书学习，准备再战。</p>

<p>2013.09.29 阿里巴巴拒信</p>

<p>人生中第一次正规的拒信，值得留作纪念。</p>

<h3>大众点评</h3>

<p>2013.10.09 大众点评笔试</p>

<p>大众点评的笔试可以说是有点怪异的，网上笔试，不过有时间限制，前面是行测的题目，后面是三道编程题目。可以上网上找答案，可以写伪代码，可以上网搜索答案。记得当时是实验室的同学一起做的，有些题目还是搞不清楚，这可能是我被大众点评秒杀的原因。</p>

<p>2013.10.12 大众点评面试</p>

<p>大众点评的面试还是比较有全面的，对照着简历一点点问。从 vi 中的快捷键到 find 命令的用法，一些基本的 linux 操作都问到了。然后开始问笔试题目怎么做的，我将我的方案说了，基本上有点像暴力搜索，记得同学给我分析过更简单的解决方案，但是当时不理解也不能讲出来到底怎么做。后来看到了我在简历中写了 python，让我用 python实现个堆栈，最简单的就是用 list，但是好久没用了，竟然把堆栈实现成了个队列，不可原谅。后来就大众点评的架构和面试官聊了会，已经知道表现的不怎么好了，最后聊的很坦然。</p>

<p>2013.10.14 大众点评拒信</p>

<p>表现的不好，收到了拒信表现的很平静。</p>

<h3>百度</h3>

<p>2013.10.13 百度笔试</p>

<p>2013.10.14 百度一面</p>

<p>2013.10.15 百度二面</p>

<p>2013.10.18 百度三面</p>

<p>2013.10.22 百度签约</p>

<p>关于百度的面试很长，在这就不详细的写了，准备开个新帖子详细的写。
在这期间还参加了几个笔试面试：</p>

<h3>创新工厂</h3>

<p>2013.10.11 创新工厂笔试，未获面试机会</p>

<h3>大华</h3>

<p>2013.10.15 大华一面游，主要是做的东西和大华的要求八字不合的感觉。</p>

<p>总体上这两个月比较累，也比较有意义，收获了人生中第一份工作，还是自己比较喜欢的，虽然不是最优的结果，但也是次优的选择了。以后要去帝都了，新的旅程在慢慢展开，未来的道路还要我慢慢去探索，加油！</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-10-22T16:11:00+08:00" pubdate data-updated="true">Oct 22<span>nd</span>, 2013</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/07/02/install-goagent3-dot-0-in-ubuntu12-dot-04/">
		
			Install goagent3.0 in ubuntu12.04</a>
	</h2>
	<div class="entry-content">
		<p>最近 goagent 升级了, 从 2.x 升级到了 3.0 速度貌似没太大的变化，但是感觉稳定了不少。最重要的变化莫过于原来是基于 python2.7 的，新版的直接依赖 python3.3,感觉真的是有点激进了。windows 下用没有任何问题，作者直接在安装包中打包了个精简版本的 python3，但是自己常用的 ubuntu 12.04 还没有安装 python3 还是要自己手动安装下的。具体的步骤可以参考官网的<a href="https://code.google.com/p/goagent/wiki/GoAgent_Linux">wiki</a>, 在按照上面的步骤安装的时候还遇到点小问题，下面是解决的过程。</p>

<h2>Python3 ImportError: No module named zlib</h2>

<p>我采用的安装方式是编译安装，按照 wiki 的命令是</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>wget http://python.org/ftp/python/3.3.2/Python-3.3.2.tar.bz2 <span class="o">&amp;&amp;</span> tar jxvf Python-3.3.2.tar.bz2 <span class="o">&amp;&amp;</span> <span class="nb">cd </span>Python-3.3.2 <span class="o">&amp;&amp;</span> ./configure <span class="o">&amp;&amp;</span> make <span class="o">&amp;&amp;</span> sudo make install
</span></code></pre></td></tr></table></div></figure>


<p>安装后在运行时就会提示 <code>ImportError: No module named zlib</code>, google 后发现有人遇到<a href="http://stackoverflow.com/questions/4134708/python3-no-gzip-or-zlib">同样的问题</a>, 页面上同样还有解决方案的<a href="http://www.1stbyte.com/2005/06/26/configure-and-compile-python-with-zlib/">链接</a>。默认编译的时候没有加上 zlib 的参数，所以将 zlib 模块添加进编译参数，重新编译安装就好。完整的编译安装的命令如下所示：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>wget http://python.org/ftp/python/3.3.2/Python-3.3.2.tar.bz2 <span class="o">&amp;&amp;</span> tar jxvf Python-3.3.2.tar.bz2 <span class="o">&amp;&amp;</span> <span class="nb">cd </span>Python-3.3.2 <span class="o">&amp;&amp;</span> ./configure -with-zlib<span class="o">=</span>/usr/include <span class="o">&amp;&amp;</span> make <span class="o">&amp;&amp;</span> sudo make install
</span></code></pre></td></tr></table></div></figure>


<p>注意 <code>./configure</code> 后面的 <code>-with-zlib=/usr/include</code> 参数。</p>

<h2>安装 PyOpenSSL 问题</h2>

<p>在执行</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>wget http://pypi.python.org/packages/source/p/pyOpenSSL/pyOpenSSL-0.13.tar.gz <span class="o">&amp;&amp;</span> tar zxvf pyOpenSSL-0.13.tar.gz <span class="o">&amp;&amp;</span> <span class="nb">cd </span>pyOpenSSL-0.13 <span class="o">&amp;&amp;</span> sudo python3 setup.py install
</span></code></pre></td></tr></table></div></figure>


<p>安装 PyOpenSSL 的时候会遇到 <code>src/crypto/x509.h:17:25: error: openssl/ssl.h: No such file or directory</code> 的问题，和这个<a href="https://tahoe-lafs.org/pipermail/tahoe-dev/2009-July/002469.html">页面</a>描述的情况一致。还是缺少某些依赖包，这个页面上也给出了解决方案，执行下面的语句，安装上 <code>libssl-dev</code> 后继续编译就好了。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>sudo apt-get install libssl-dev
</span></code></pre></td></tr></table></div></figure>


<p>自此 goagent3.0 应该可以在 ubuntu 12.04 下正常的工作了，记得还有个包需要安装，不过不影响运行，且有提示，按照提示安装好需要的包就可以了。</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-07-02T18:37:00+08:00" pubdate data-updated="true">Jul 2<span>nd</span>, 2013</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/03/23/vpsan-zhuang-delugebing-she-zhi-iptablesgui-ze/">
		
			Vps 安装 Deluge 并设置 Iptables 规则</a>
	</h2>
	<div class="entry-content">
		<p>昨天 HDC 的下载网站终于恢复了，换了个马甲 <a href="www.hdwing.com">hdwing.com</a> 重新开始提供 PT 服务。原有的 HDC 的数据都还在，网站也迁移到了美国感觉靠谱多了，至少不用担心莫名其妙的被拔网线的问题了。登陆后看了下，除了 logo 更换了，其他的都是那么的熟悉，看到了自己的数据都还在，顿时泪流满面。</p>

<h2>下载工具</h2>

<p>Windows 下没什么挑剔的，用 utorrent 就一切 ok。Linux 却要费一番思量，PT 网站支持的客户端还挺多的，有 ktorrent、rtorrent、transmission 和 deluge 等等。以前一直在用 ubuntu 自带的 transmission, 挺简洁也很小巧，但是悲剧的是从 ubuntu 12.04 起，transmission 升级到了2.77 版，HDC 支持的 transmission 最新也直到了 2.73 版，所以就悲剧了。deluge 貌似支持的到了最新的 1.3.5 版本了，所以就准备安装 deluge 作为下载工具了。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>sudo apt-get install deluged deluge-web
</span></code></pre></td></tr></table></div></figure>


<p> 执行上述的命令就安装好了，具体的如何设置的可以参见这篇 <a href="http://sunsea.im/deluge-config.html">blog</a>。</p>

<h2>设置 nginx 代理</h2>

<p>deluge 安装后默认的在 8182 端口打开 web 服务，但是因为 vps 上已经安装上了 LNMP 环境，所以想用 nginx 将 8182 端口映射到 80 端口，减少端口暴露，同时也便于管理。本文参考了 <a href="http://blog.dayanjia.com/2012/12/seedbox-configuration-example/">Seedbox配置实例</a> ,和 <a href="http://forum.deluge-torrent.org/viewtopic.php?f=8&amp;t=39329">deluge forum</a>。</p>

<h3>nginx 文件配置</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>将下列配置写入 nginx 域名配置文件
</span><span class='line'>server <span class="o">{</span>
</span><span class='line'>   <span class="c">### server port and name ###</span>
</span><span class='line'>   listen            0.0.0.0:80;
</span><span class='line'>   listen            <span class="o">[</span>::<span class="o">]</span>:80;
</span><span class='line'>   server_name         your.domain.net;
</span><span class='line'>   <span class="k">if</span> <span class="o">(</span><span class="nv">$host</span> !~* ^<span class="o">(</span>your.domain.net<span class="o">)</span><span class="nv">$ </span><span class="o">)</span> <span class="o">{</span> <span class="k">return </span>444; <span class="o">}</span> <span class="c">#URL non matché par le domaine</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>   <span class="c">### Compression ###</span>
</span><span class='line'>   gzip            on;
</span><span class='line'>   gzip_static         on;
</span><span class='line'>   gzip_buffers         32 8k;
</span><span class='line'>   gzip_comp_level         3;
</span><span class='line'>   gzip_http_version      1.1;
</span><span class='line'>   gzip_types         text/css text/xml application/x-javascript application/atom+xml text/mathml text/plain t
</span><span class='line'>ext/vnd.sun.j2me.app-descriptor text/vnd.wap.wml text/x-component image/x-ms-bmp image/svg+xml application/msword application/rt
</span><span class='line'>f application/xml application/xhtml+xml application/xml+rss text/javascript application/javascript application/json;
</span><span class='line'>   gzip_vary         on;
</span><span class='line'>
</span><span class='line'>   location / <span class="o">{</span>
</span><span class='line'>      proxy_pass      http://localhost:8112/;
</span><span class='line'>      proxy_next_upstream   error timeout invalid_header http_500 http_502 http_503;
</span><span class='line'>
</span><span class='line'>      <span class="c">### Set headers ####</span>
</span><span class='line'>      proxy_set_header   Host         <span class="nv">$host</span>;
</span><span class='line'>      proxy_set_header   X-Real-IP      <span class="nv">$remote_addr</span>;
</span><span class='line'>      proxy_set_header   X-Forwarded-For      <span class="nv">$proxy_add_x_forwarded_for</span>;
</span><span class='line'>
</span><span class='line'>      <span class="c">### By default we don&#39;t want to redirect it ####</span>
</span><span class='line'>      proxy_redirect      off;
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>   location ~*^.+<span class="o">(</span>ico|css|js|gif|jpe?g|png<span class="o">)</span><span class="nv">$ </span><span class="o">{</span>
</span><span class='line'>                proxy_pass              http://localhost:8112;
</span><span class='line'>      expires         max;
</span><span class='line'>
</span><span class='line'>                proxy_next_upstream     error timeout invalid_header http_500 http_502 http_503;
</span><span class='line'>
</span><span class='line'>                <span class="c">### Set headers ####</span>
</span><span class='line'>                proxy_set_header        Host                    <span class="nv">$host</span>;
</span><span class='line'>                proxy_set_header        X-Real-IP               <span class="nv">$remote_addr</span>;
</span><span class='line'>                proxy_set_header        X-Forwarded-For         <span class="nv">$proxy_add_x_forwarded_for</span>;
</span><span class='line'>
</span><span class='line'>                <span class="c">### By default we don&#39;t want to redirect it ####</span>
</span><span class='line'>                proxy_redirect          off;
</span><span class='line'>   <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>通过上面的设置你可以通过 <code>http://your.domain.net</code> 来管理 deluge，和通过 <code>http:// your-ip:8112</code> 效果一致。</p>

<h2>iptables 设置</h2>

<p>默认的情况 deluge 的 incoming ports 和 outgoing ports 都使用的是 random ports,也就是随机端口，这样无法使用 iptables 控制 vps 的访问，造成很大的安全漏洞。deluge 也提供了端口设置，默认的是 6881 到 6891，但是郁闷的是我将 6881-6891的端口的进出都在 iptables 规则中设置为了 accept，连接 pt 服务器的时候还是会显示 blocked, 来回的折腾，关掉/打开 iptables、重启 deluge、甚至最后重启 vps，都是一样的效果。搞了一下午无任何进展，然后突然我想起来是不是端口被服务商封锁了，将默认的端口从 6881-6891 设置为了 56800-56810,然后就工作正常了，WTF。</p>

<h3>iptables 规则</h3>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>iptables -A INPUT -p TCP --dport 56800:56810 -j ACCEPT
</span><span class='line'>iptables -A INPUT -p UDP --dport 56800:56810 -j ACCEPT
</span><span class='line'>iptables -A OUTPUT -p TCP --sport 56800:56810 -j ACCEPT
</span><span class='line'>iptables -A OUTPUT -p UDP --sport 56800:56810 -j ACCEPT
</span></code></pre></td></tr></table></div></figure>


<p>经过了上面的设置，deluge 运行还是比较平稳的，占用的资源不是很多。vps 网速特别给力， 上传高峰可达到 5M/s，真是相当不错, 只是硬盘容量太小很遗憾啊。</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-03-23T15:46:00+08:00" pubdate data-updated="true">Mar 23<span>rd</span>, 2013</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2013/03/06/tar-pai-chu-zhi-ding-mu-lu/">
		
			Tar 排除指定目录</a>
	</h2>
	<div class="entry-content">
		<p>很久没有写 blog 了感觉 blog 已经荒废了。上一篇文章在 2012 年底，现在都 2013 年了，2 个多月就这么过去了。在这两个多月从大部分时间在家过年什么都没有做，一直在歇着。1 月底的时候 yardvps 打 5 折， 把 blog 迁移到了这个新的 vps 了，感觉运行很稳定，价格还是很实惠的。blog 搬家没有遇到什么问题，但是今天在用 tar 备份网站的时候遇到点问题，如何排除指定的目录。</p>

<h2>什么是 tar</h2>

<p>Unix和类Unix系统上的压缩打包工具，可以将多个文件合并为一个文件，打包后的文件名亦为“tar”。目前，tar文件格式已经成为POSIX标准，最初是POSIX.1-1988，目前是POSIX.1-2001。 本程序最初的设计目的是将文件备份到磁带上(tape archive)，因而得名tar。(摘抄自维基百科)</p>

<h2>问题</h2>

<p>我准备是用 tar 备份我的 wordpress 网站的，但是里面有一个目录是 wp-content 下面的 backup 目录有以前的备份，我想把这个排除掉，想起以前用 tar 备份系统的时候用的 &mdash;exclude 参数，开始是这么写的：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">cd</span> /home/wwwroot
</span><span class='line'>tar cpzf www.mars.tingxuere.com.tar.gz www.mars.tingxueren.com --exclude<span class="o">=</span>www.mars.tingxueren.com/wp-content/backup/
</span></code></pre></td></tr></table></div></figure>


<p>很遗憾运行后还是不行，我以为是路径写的有问题，下面用绝对路径</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">cd</span> /home/wwwroot
</span><span class='line'>tar cpzf www.mars.tingxuere.com.tar.gz www.mars.tingxueren.com --exclude<span class="o">=</span>/home/wwwroot/www.mars.tingxueren.com/wp-content/backup/
</span></code></pre></td></tr></table></div></figure>


<p>同样还是不行的，不知道为什么，感觉可能是 &mdash;exclude 参数我的理解有问题。</p>

<h2>实验</h2>

<p>首先 man tar 看看 &mdash;exclude 参数是干吗的:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'> --exclude<span class="o">=</span>PATTERN
</span><span class='line'>       exclude files, given as a PATTERN
</span></code></pre></td></tr></table></div></figure>


<p>从上面看到 &mdash;exclude 排除的目录不是目录的路径，而是按照正则表达式的形式排除的，PATTERN是也。理解错误在 &mdash;exclude 后面跟路径当然达不到我的目标，下面是个很简单的实验：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/home/user
</span><span class='line'><span class="nv">$ </span>mkdir <span class="nb">test</span>
</span><span class='line'><span class="nv">$ </span><span class="nb">cd test</span>
</span><span class='line'><span class="nv">$ </span>mkdir test01 test02
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>test01
</span><span class='line'><span class="nv">$ </span>touch test01.txt
</span><span class='line'><span class="nv">$ </span><span class="nb">cd</span> ../test02
</span><span class='line'><span class="nv">$ </span>touch test02.txt
</span><span class='line'><span class="nv">$ </span><span class="nb">cd</span>
</span><span class='line'><span class="nv">$ </span>tar cvzf test.tar.gz <span class="nb">test</span> --exclude<span class="o">=</span>/home/user/test/test02
</span><span class='line'><span class="nb">test</span>/
</span><span class='line'><span class="nb">test</span>/test01/
</span><span class='line'><span class="nb">test</span>/test01/test01.txt
</span><span class='line'><span class="nb">test</span>/test02/
</span><span class='line'><span class="nb">test</span>/test02/test02.txt
</span><span class='line'><span class="c"># 可以看到 --exclude 没有起到效果</span>
</span><span class='line'><span class="nv">$ </span>tar cvzf test.tar.gz <span class="nb">test</span> --exclude<span class="o">=</span>test02/
</span><span class='line'><span class="nb">test</span>/
</span><span class='line'><span class="nb">test</span>/test01/
</span><span class='line'><span class="nb">test</span>/test01/test01.txt
</span><span class='line'><span class="nb">test</span>/test02/
</span><span class='line'><span class="nb">test</span>/test02/test02.txt
</span><span class='line'><span class="c"># --exclude 依然没有效果，因为 tar 打包过程中找不到与 test02/ 匹配的项目，注意最后的`/`</span>
</span><span class='line'><span class="nv">$ </span>tar cvzf test.tar.gz <span class="nb">test</span> --exclude<span class="o">=</span>test02
</span><span class='line'><span class="nb">test</span>/
</span><span class='line'><span class="nb">test</span>/test01/
</span><span class='line'><span class="nb">test</span>/test01/test01.txt
</span><span class='line'><span class="c"># 顺利的达到目标</span>
</span><span class='line'><span class="c"># --exclude 后面是正则表达式，还可以排除文件夹中具体的文件</span>
</span><span class='line'><span class="c"># 保留 test02 文件夹，去除 test02.txt</span>
</span><span class='line'><span class="nv">$ </span>tar cvzf test.tar.gz <span class="nb">test</span> --exclude<span class="o">=</span>test02/*.txt
</span><span class='line'><span class="nb">test</span>/
</span><span class='line'><span class="nb">test</span>/test01/
</span><span class='line'><span class="nb">test</span>/test01/test01.txt
</span><span class='line'><span class="nb">test</span>/test02/
</span></code></pre></td></tr></table></div></figure>


<h2>疑惑</h2>

<p>在搜索过程中看到了有人写到：在 GNU tar 中用 &mdash;exclude 参数时，被打包的文件必须要放在最后，否则没有效果，但是我实验了下发现被打包文件放在前面和后面都是一样的，不知是这个 bug 被修复了，还是以讹传讹的错误：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>tar --version
</span><span class='line'>tar <span class="o">(</span>GNU tar<span class="o">)</span> 1.26
</span><span class='line'>Copyright <span class="o">(</span>C<span class="o">)</span> 2011 Free Software Foundation, Inc.
</span><span class='line'>License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;.
</span><span class='line'>This is free software: you are free to change and redistribute it.
</span><span class='line'>There is NO WARRANTY, to the extent permitted by law.
</span><span class='line'>
</span><span class='line'>Written by John Gilmore and Jay Fenlason.
</span><span class='line'><span class="c"># test 放在 --exclude 前面</span>
</span><span class='line'><span class="nv">$ </span>tar cvzf test.tar.gz <span class="nb">test</span> --exclude<span class="o">=</span>test02
</span><span class='line'><span class="nb">test</span>/
</span><span class='line'><span class="nb">test</span>/test01/
</span><span class='line'><span class="nb">test</span>/test01/test01.txt
</span><span class='line'><span class="c"># test 放在 --exclude 后面</span>
</span><span class='line'><span class="nv">$ </span>tar cvzf test.tar.gz  --exclude<span class="o">=</span>test02 <span class="nb">test</span>
</span><span class='line'><span class="nb">test</span>/
</span><span class='line'><span class="nb">test</span>/test01/
</span><span class='line'><span class="nb">test</span>/test01/test01.txt
</span><span class='line'><span class="c"># 可以看到上述两种写法，执行效果一致</span>
</span></code></pre></td></tr></table></div></figure>


		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2013-03-06T19:07:00+08:00" pubdate data-updated="true">Mar 6<span>th</span>, 2013</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2012/12/27/2012nian-du-zong-jie/">
		
			2012年度总结</a>
	</h2>
	<div class="entry-content">
		<p>转眼间又到了岁末，世界依然没有毁灭，世界末日原来只是个小笑话而已，连圣诞节都过了，看来可以踏实的迎接新的一年的到来了。一年就这么不知不觉的过去了，刚还感叹夏天热的要死，现在又在烦恼这不停下雨的冬日，日子就这么不经意的过。既然到了岁末就不能免俗，盘点下一年的得失展望下新的一年就是应有之意。</p>

<p>貌似这一年确实没干太多的事情，但也不是全无收获。上学期结束了所有的课程，估计是这辈子在教室中上课的经历就到此为止了。但是课堂上大部分学的东西现在就快忘记了，学过的东西不用的话确实忘记的很快。貌似学了点嵌入式的课程，虚拟现实技术，数据挖掘什么的，现在留在脑子里的东西估计就剩下点名词，实在是惭愧。貌似上半年还在研究 c++ 和 python，c++ 看的好长在4月份的时候终于看完了一遍，只是看完，但是还是不会用的，需要大量的练习才能熟练。研究 python 的原因很简单，就是看到了常用的翻墙软件 GoAgent 就是用 python 写的，代码也就 1000 多行，但是就能用了，感觉很神奇就想看看 python 是什么。看了几本 python 的书，发现了这种语言和常用的 c/c++ 不一样，是种动态的语言，写起来特别的自由，不用关注各种声明、类型等等细节的问题，只关注如何解决问题，用语言将你的想法表现出来就好，确实很好用。用 python 很笨拙的实现了个小词典，功能很简陋，不过是自己写的第一个能用的 python 程序感觉还是很不错，终于自己能编程解决点小问题了，这种感觉相当的棒。</p>

<p>今年的暑假是首次没在家过的暑假，只回家了一周。本来是准备在家呆更长的时间的，但是因为是偷偷的跑的，没和老板打招呼，像个逃兵似的，很快就回来了。暑假开始研究老板布置任务，夸张点来说是要做科研了。暑假主要看了点论文，了解了点什么是 SVM，发现这个还是很好用的，虽然提出的不是特别的久，但是已经应用的很广泛了。假期之间还学了点 shell 编程和 Git，shell 配合着 awk 、sed 这些小工具来处理文本确实很强悍，用着相当的爽。Git 学习了点，现在基本上会用，Github 很不错，上面有一堆很有用的项目，貌似现在的程序猿没在 Github 上托管点项目就不好意思和人打招呼似的。现在把 Github 当备份仓库和 blog 来用，相当的不错。</p>

<p>整个下半年基本在折腾项目了，老板的要求很高，但是一直找不到合适的切入点，这点让人纠结死了。从图像到生物特征识别到数据挖掘是来回的折腾，现在主要是整数据挖掘了，做点研究才发现原来学的以为没什么用的数学终于有用场了，现在看书常感觉数学功底不够看不懂，这就是所谓的书到用时方恨少吧。9月到10月还学习了点正则表达式和
perl 语言，正则表达式是个强大的工具，在处理文本时候特别的有用。</p>

<p>整整一年，彻底的皈依了 Linux 教，完全用 Linux 当作主机用了一年。从一个菜鸟渐渐的学会了走，渐渐的不那么菜了，也会点小技巧了，我相信继续努力总有一天我会学会飞翔的。玩了 Linux 一年了解了系统的启动，软件的安装，编译，调试等等细节，学会了写点小脚本解决碰到的小问题。这一年养成了在终端下干活的习惯，感觉终端真是的牛逼的东西，还养成了对图形界面莫名其妙的优越感，这点很没必要一定要改正。师兄们走后用他们的电脑当服务器折腾了好几个月，终于知道了 Linux 服务器是怎么干活的了，初步的会配置个能干活的服务器了，后来又买了 VPS 自己管理发现真正的要保证服务器的高可用性是个很大的挑战。玩服务器有种大权操之我手的感觉，这感觉真不错，以后确实想去当 SA，据说压力比较大，但是喜欢就好。后来买了个域名，从不懂到懂，一步步建立了 bolg，搭建 blog 环境，配置 VPS，一整套做下来对书上写的东西理解的更透彻了，原来这些也不是特别的神秘。</p>

<p>这一年还是与 #GFW 斗争的一年，在与 #GFW 斗争的过程中我还学习到了很多的知识，从好的一方面来讲 #GFW 是学习的动力，有了 #GFW 中国的程序猿的网络编程水平有了大幅度的提高。折腾过了 GAE 系列的工具，SSH，VPN，还买了个路由器在路由器上跑 VPN, 效果还不错。总体来看墙是慢慢加高的，那就继续和 #GFW 玩猫捉老鼠的游戏吧，直到彻底玩完为止。绝不妥协！！！</p>

<p>2012年大部分是在实验室中度过的，但是还是出去过几次的。春天去太子湾看樱花，雪白的樱花配着红色的郁金香特别的好看；夏天的西湖的荷花也颇为可观；中秋的时候欣赏钱塘潮水确实感受到了潮水的凶险，当时看到了大潮过去了，感觉在岸边看到不过瘾，就冒险下到了丁字坝上靠近看潮水，刚拍了几张照片，突然看到了水面以肉眼可见的速度上涨了，赶紧的想跑上岸，但是已经来不及了，幸好回头潮是拍在靠近堤坝的一侧而不是我们站立的靠江心一侧我们才捡了条小命。这是我这几年面临的最危险的情况，吓死了，幸运的是没有出现悲剧；还去了上海去2次，基本上走马观花，随便看看，上海的那些中西合璧的老建筑还是很不错的。没有爬过山，没有去海边是这一年的遗憾，希望下一年能有机会去爬爬山，去海边吹吹风。</p>

<p>这一年来遗憾的事情确实还很不少，感情方面还是一无所获，悲剧啊！学业方面貌似没什么太大的进步，没有为课堂生涯划上个圆满的句号。研究方面才刚刚开始，前途应该是很光明的，多努力我相信我会捡到属于我的那个贝壳。总体来说这一年还是比较充实的，有努力、有收获、有悔恨、有遗憾，研究生的生涯已经过了一半，貌似明年这个时候基本上就结束了，压力很大，自身的缺陷还很多，不知道明年能不能为自己找到个好买家。一切空想均是无用，脚踏实地的弥补自己的不足，提升自己的能力才是王道，以此自勉！ 2012 就要过去，很快会迎来新的一年，新的一年是充满挑战的，希望自己能好好把握新的一年，能在新的一年过的精彩，在明年这个时候写总结的时候我希望我是在笑着写的！</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-12-27T18:24:00+08:00" pubdate data-updated="true">Dec 27<span>th</span>, 2012</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2012/12/07/chu-chi-de-fen-nu/">
		
			出离的愤怒</a>
	</h2>
	<div class="entry-content">
		<p>最近翻墙一直不正常，从“斯巴达”之前开始的，以为是党国开会，正常现象，等过一段时间会开完了，党国的 G 点降低了就会恢复正常。但是美好的期望却往往得到失望的结果，会议早已开完，但是网络封锁却越发的严重了。现在的情况是：openvpn 全线阵亡，即使可以加上前端代理，通过443端口也是命不久已；ssh 隧道基本正常，但是感觉貌似 #GFW 已经很聪明的学会了流量类型识别，通过 ssh 上网没问题，但是想通过 ssh 给 ubuntu 更新下 chrome 都成了问题， WTF；GAE 系统的基本上还算正常，多亏了 google 有 N 多的 ip。一个 ip 网段封锁后换新的 ip 又是一条好汉，所有 ip 都被封锁的那天就不折腾了，那时估计大中华局域网早就建成了。GAE 无法正常的传输 https 的流量，只能用伪造证书来勉强支持 https，慎用为妙。</p>

<p>GFW 的技术水平越来越高了，现在的翻墙简直就是像当年的游击战的架式，你来我往互有攻防。最开始的时候的网页代理，然后的轮子的一批工具，以“自由门”为代表，再然后是 GAE 平台的工具，SSH 隧道，各种 vpn。一个个都前赴后继的被挂掉了，人们牢牢的被封锁在高墙之中，能够自由呼吸的空间越来越少。特别是最近 #GFW 的技术有了很大的进步，基于 openssl 的各种工具都要快失效了。为了更好的对付人们的翻墙手段，竟然引入了机器学习的手段来对加密流量进行分析，打击准确，见血封喉，大家可以拜读下方院士近期发表的<a href="/docs/%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F%E5%88%86%E7%B1%BB%E7%A0%94%E7%A9%B6%E8%BF%9B%E5%B1%95%E4%B8%8E%E5%B1%95%E6%9C%9B.pdf">这篇大作</a>，相信会有不少收获。</p>

<p>都忘记了什么时候开始翻墙了，貌似是莫一天搜索到了有趣的帖子，但是点击链接却是“链接被重置”，现在感觉到很熟悉的错误提示信息，当时却是一片茫然。人都是有好奇心的，越不让人看的东西却千方百计的想看到，压迫的越狠，反抗的越厉害。最终我还是看到了，了解到了 “墙”、“功夫网”、“GFW” 等等的这些很有些特殊含义的词汇。从开始的简单的通过网页翻墙，到现在尝试了 N 种工具却无法翻越这座高墙，我慢慢的明白的墙的含义。</p>

<h2>墙的不断升级就是在给你造成一种压力：别折腾了，你斗不过我的。单个人是无法与国家相抗衡的，但你放弃的时候，有个躲在角落的人会偷偷的在笑。翻墙是一种姿态，无论多难，都不要放弃，这代表了一种不妥协的勇气。</h2>

<p>其实翻墙的目的很简单，就是为了用更好的服务。当你在 Baidu 上想找个软件，在搜索的结果中翻了几页才找到软件的官网时，当你想搜索点学术论文时，你会发现 google 是你更好的选择。为了全平台的同步我的文件我选择了 Dropbox， 不幸也被墙掉，flickr 被墙，blogger 被墙，Twitter 被墙，Facebook 被墙 。。。 貌似好东西都会被墙掉，被 #GFW 认证的东西才被认为是有价值的，然后国内冒出来一批山寨的东西。互联网本来是没有国界的，但是貌似现在变成了两个网络，一个是国际互联网，一个是中国互联网，好像什么东西到了中国都会变成了“有中国特色”，真是奇怪。可能你感觉墙了就墙了，反正这些服务我从来不用，和我没关系，是的，短时间是没关系的，但是从长远来看，关起门来自娱自乐会让我们与这个快速发展的世界脱节，重新回到“天朝”的迷梦中。“我大清”可是万邦来朝，呵呵。。。</p>

<h3>有压迫的地方就有反抗，是楼总是会塌的，是墙总是会倒的，我坚信这一点。希望在不久的将来让我能忘记墙这码事，能够自由的访问互联网。</h3>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-12-07T21:44:00+08:00" pubdate data-updated="true">Dec 7<span>th</span>, 2012</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2012/11/29/today-is-sb/">
		
			Today Is SB</a>
	</h2>
	<div class="entry-content">
		<p>这两天遇到了很 SB 的事情，在脑袋冲动的情况下做出了很多 SB 的不理智的决定。记录下来，等以后再 SB 的时候拿出来看看。</p>

<h2>缘起</h2>

<p>一切的开端始于昨天早上，一早到实验室就发现我无法通过 SSH 登陆到我的 VPS 了。虽然现在手里的这个 VPS 有很多的不足：OpenVZ 架构的，空间很小，最近服务不稳定，特别是最近基本上三天两头的宕机。 但是总体上还是不错的，流量不限制，延迟很小，在上面搭建的 openvpn 虽然已经被 #GFW 干废掉了，但是添加上前端代理后还是可以用的，最重要的还是比较便宜，一个月不到40块还是能接受的。</p>

<h2>发展</h2>

<p>突然不能 SSH 登录了，但是网站和 openvpn 都正常的工作，第一个念头是伟大的 #GFW 的干扰，#GFW 做这件事情不是一次两次了。但是挂上全局 VPN 后依然无法 SSH 登陆 。看了不是 #GFW 的问题，以为是 iptables 的问题了，进入管理网页清空 iptables 规则后还是不行，通过网页重启了机器后还是不行，火大了。运营商提供的网页的 consle的端口也被禁用了，救命稻草也没了，不清楚到底出现了什么问题，给运营商发邮件但是迟迟收不到邮件。脑子抽了准备恢复系统了，还好 ftp 还是正常的，通过 ftp 备份了不少配置和网站的文件，还好应该损失不大。</p>

<p>等系统重置完成了，收到了回复的邮件：运营商在做虚拟机的迁移，在此期间 VPS 可能工作不正常。我估计 SSH 无法登陆的原因是但是我的 VPS 正在做迁移，VPS 其实是工作正常的，应该是为了迁移的安全运营商暂停了 SSH 的登陆。把系统重装了纯粹是瞎忙活，没办法了，系统重置了还是要把它恢复原装的。按照正常的步骤，登陆，升级，建立账户，设置配置。重启，然后又进不去了，诡异的画面一再出现，把我郁闷的不行，都要吐血了。</p>

<h2>高潮</h2>

<p>昨天夜里又尝试了好几次，恢复了几次系统。问题依旧，开始能登上，升级系统，打打补丁后又登陆不上去了，仔细的排查过了 iptables , sshd_config 都没什么问题。然后就想干脆换个 VPS 提供商吧。逛逛网站发现了 YardVPS ，现在有7折的优惠，一个月35块，和我现在用的差不多。一冲动又拍脑袋买了个，忘记了网上各位对他家服务的诟病 。开通邮件倒是很快收到了，控制面板上也显示了 VPS 已经再线，但是就是 ping 不通，也无法 SSH 登陆。YardVPS 立马给我展示了他们的糟糕的服务，邮件发了，后台看到正在跑了，但是其实 VPS 还是没有开通。google 了下看来和我有同样遭遇的不只一个人。没办法只好发 ticket，杯具的美国时间还没上班，要等到美国人上班了才会处理 ticket，怀着郁闷的心情睡觉去了。</p>

<h2>后续</h2>

<p>早上来了，发现新买的这个 VPS 终于开通了，配置下吧。发现除了客服不给力和美国线路延迟大上传下载比较慢之外，其他的基本比较满意。上午收到了原来的 VPS 提供商的邮件，维护结束一切正常。但是我的 VPS 还是无法用 SSH 登陆，重新生成系统，打补丁，重启，又不能登陆系统了。次凹，到底是怎么回事，突然我想起来了在升级系统前是可以登陆的，升级系统后就不可以登陆了，问题一定出在了系统更新的头上。再次生成系统，慢慢的一步步升级系统，终于找到原因了，原来系统升级的时候会更改 <code>/etc/init/ssh.conf</code> 这个文件，本来默认的规则是保留现在用的，但是脑子抽了，就选择成了升级规则了，新规则估计和主机不兼容什么的然后就不能用，好郁闷啊，原来事情就是这么简单，搞得我折腾了 2 天，重装了系统不下于 10 次。我真的是个 SB。</p>

<h2>终章</h2>

<p>现在 VPS 终于恢复到了和一前一样了，貌似跑的也很顺畅。一番折腾纠结了 2 天，多买了个不需要的 VPS ，浪费了一个月钱。现在只能想让两个都跑着，观察下，看那个更稳定下个月就用哪个了。看来“冲动是魔鬼”确实所言不虚，脑子不冷静的状态下做的决定往往会把事情搞的更糟糕，引以为戒吧，以后再犯二的时候就回头来看看这篇帖子。</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-11-29T20:26:00+08:00" pubdate data-updated="true">Nov 29<span>th</span>, 2012</time></div>
	<div class="tags">

</div>
	
</div>
</article>


    <article class="post">
	<h2 class="title">
		
		<a href="/blog/2012/11/24/linux-chang-yong-wang-luo-gong-ju/">
		
			Linux 常用网络工具</a>
	</h2>
	<div class="entry-content">
		<p>既然享受了上网的便利，有时候就不得不忍受网络带来的痛苦。正上网看视频看的 high, 突然网页卡死了，刷新后网页都打不开，正聊 QQ 突然掉线了，想访问些国外网站发现输入域名后跳转到莫名其妙的网站，这时候你就要检查下自己的网络问题了。“工欲善其事，必先利其器”， Linux 下有很好用的网络工具，掌握了这些工具基本上就能找到网络出毛病的原因，自己动手修复了。</p>

<h2>常用工具</h2>

<p>常用的工具一般有：ping、ifconfig、traceroute、nslookup、dig、whois、iftop、ntop等，下面简要介绍下</p>

<h3>ping</h3>

<p>ping 很简单，也是最常用的工具，常常用来测试网络是否联通，用法：ping ip/host 即可，Windows 下也用同样的命令</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># 测试网络是否联通</span>
</span><span class='line'><span class="nv">$ </span>ping  baidu.com
</span><span class='line'><span class="c"># 有时候 ping 的返回会很慢，这是因为 ping 会尽量将 ip 转化为域名，如果对应 ip 没有设置域名</span>
</span><span class='line'><span class="c"># 解析的话会直到超时才返回，可以添加 -n 参数，让 ping 立即得到返回数据</span>
</span><span class='line'><span class="nv">$ </span>ping -n 8.8.8.8
</span></code></pre></td></tr></table></div></figure>


<h3>ifconfig</h3>

<p>ifconfig 是用来查看本机网络的各种接口的， Windows 下对应命令为 ipconfig</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># 本机执行 ifconig</span>
</span><span class='line'><span class="nv">$ </span>ifconfig
</span><span class='line'>eth0      Link encap:Ethernet  HWaddr 8c:89:a5:39:**:**
</span><span class='line'>          inet addr:192.168.1.100  Bcast:192.168.1.255  Mask:255.255.255.0
</span><span class='line'>          inet6 addr: fe80::8e89:a5ff:fe39:5c96/64 Scope:Link
</span><span class='line'>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
</span><span class='line'>          RX packets:3591303 errors:0 dropped:10 overruns:0 frame:0
</span><span class='line'>          TX packets:3219419 errors:0 dropped:0 overruns:0 carrier:0
</span><span class='line'>          collisions:0 txqueuelen:1000
</span><span class='line'>          RX bytes:3257148705 <span class="o">(</span>3.2 GB<span class="o">)</span>  TX bytes:448474566 <span class="o">(</span>448.4 MB<span class="o">)</span>
</span><span class='line'>          Interrupt:43 Base address:0xe000
</span><span class='line'>
</span><span class='line'>lo        Link encap:Local Loopback
</span><span class='line'>          inet addr:127.0.0.1  Mask:255.0.0.0
</span><span class='line'>          inet6 addr: ::1/128 Scope:Host
</span><span class='line'>          UP LOOPBACK RUNNING  MTU:16436  Metric:1
</span><span class='line'>          RX packets:321987 errors:0 dropped:0 overruns:0 frame:0
</span><span class='line'>          TX packets:321987 errors:0 dropped:0 overruns:0 carrier:0
</span><span class='line'>          collisions:0 txqueuelen:0
</span><span class='line'>          RX bytes:75444551 <span class="o">(</span>75.4 MB<span class="o">)</span>  TX bytes:75444551 <span class="o">(</span>75.4 MB<span class="o">)</span>
</span><span class='line'>
</span><span class='line'><span class="c"># MAC地址我做了注释，可以看到本机只用一个网卡 eth0，lo 为本地环回接口</span>
</span><span class='line'><span class="c"># 本机 ip 为 192.168.1.100, 为一个私有地址，因为我的电脑是接在路由器下面的</span>
</span><span class='line'><span class="c"># 其他参数可以 man ifconfig</span>
</span></code></pre></td></tr></table></div></figure>


<h3>traceroute</h3>

<p>traceroute 是个路由跟踪命令，可以跟踪从本机到目标 ip 的具体路由过程，Windows 下对应的命令是 tracert</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># 本机跟踪到 baidu.com 的路由过程</span>
</span><span class='line'><span class="nv">$ </span>traceroute baidu.com
</span><span class='line'>traceroute to baidu.com <span class="o">(</span>123.125.114.144<span class="o">)</span>, 30 hops max, 60 byte packets
</span><span class='line'> 1  192.168.1.1 <span class="o">(</span>192.168.1.1<span class="o">)</span>  0.485 ms  1.117 ms  1.313 ms
</span><span class='line'> 2  192.168.149.254 <span class="o">(</span>192.168.149.254<span class="o">)</span>  4.472 ms  4.754 ms  4.785 ms
</span><span class='line'> *
</span><span class='line'> *
</span><span class='line'> 9  219.158.14.97 <span class="o">(</span>219.158.14.97<span class="o">)</span>  43.474 ms  43.522 ms  43.695 ms
</span><span class='line'>10  123.126.0.66 <span class="o">(</span>123.126.0.66<span class="o">)</span>  47.145 ms  47.186 ms  47.248 ms
</span><span class='line'>11  61.148.3.34 <span class="o">(</span>61.148.3.34<span class="o">)</span>  49.409 ms  49.523 ms  49.417 ms
</span><span class='line'>12  202.106.43.66 <span class="o">(</span>202.106.43.66<span class="o">)</span>  39.283 ms 202.106.43.174 <span class="o">(</span>202.106.43.174<span class="o">)</span>  40.238 ms  40.661 ms
</span><span class='line'>29  * * *
</span><span class='line'>30  * * *
</span><span class='line'>
</span><span class='line'><span class="c"># 为了保密删除了开头的几条路径</span>
</span><span class='line'><span class="c"># 有些路由禁止探测，比如第29, 30 跳</span>
</span><span class='line'><span class="c"># 最多跳数为 30, 到了30 跳虽然还没有到 baidu.com 但是命令结束了</span>
</span></code></pre></td></tr></table></div></figure>


<h3>nslookup</h3>

<p>nslookup 是用来查询 DNS 解析的，通过这个命令可以明显的看到 GFW 的常用手段 “DNS污染”。Windows 下的命令相同</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># 执行 nslookup 用国内 DNS 服务器</span>
</span><span class='line'><span class="c"># 命令格式: nslookup 域名 DNS服务器</span>
</span><span class='line'><span class="c"># 查询 twitter.com 通过国内DNS服务器</span>
</span><span class='line'><span class="nv">$ </span>nslookup twitter.com  221.12.1.227
</span><span class='line'>Server:       221.12.1.227
</span><span class='line'>Address:  221.12.1.227#53
</span><span class='line'>
</span><span class='line'>Non-authoritative answer:
</span><span class='line'>Name: twitter.com
</span><span class='line'>Address: 59.24.3.173
</span><span class='line'><span class="c"># 通过 whois 查询可知 59.24.3.173 是个韩国ip</span>
</span><span class='line'><span class="c"># 挂上 vpn 通过 google dns 查询得到正确ip</span>
</span><span class='line'><span class="nv">$ </span>nslookup twitter.com  8.8.8.8
</span><span class='line'>Server:       8.8.8.8
</span><span class='line'>Address:  8.8.8.8#53
</span><span class='line'>
</span><span class='line'>Non-authoritative answer:
</span><span class='line'>Name: twitter.com
</span><span class='line'>Address: 199.59.150.39
</span><span class='line'>Name: twitter.com
</span><span class='line'>Address: 199.59.149.230
</span><span class='line'>Name: twitter.com
</span><span class='line'>Address: 199.59.148.10
</span></code></pre></td></tr></table></div></figure>


<h3>dig</h3>

<p>dig 命令和 nslookup 十分相似，也是用来进行 DNS查询的，命令格式也很简单 <code>dig @server host</code> 即可。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># 我把我的另一个域名 tingxueren.info 指向了 tingxueren.github.com 在 github 上面维护了自己的blog，可以用</span>
</span><span class='line'><span class="c"># dig 查询下，会发现 ip 一致</span>
</span><span class='line'><span class="c"># dig tingxueren.info</span>
</span><span class='line'><span class="nv">$ </span>dig @8.8.8.8 tingxueren.info
</span><span class='line'>
</span><span class='line'>; &lt;&lt;&gt;&gt; DiG 9.8.1-P1 &lt;&lt;&gt;&gt; @8.8.8.8 tingxueren.info
</span><span class='line'>; <span class="o">(</span>1 server found<span class="o">)</span>
</span><span class='line'>;; global options: +cmd
</span><span class='line'>;; Got answer:
</span><span class='line'>;; -&gt;&gt;HEADER<span class="s">&lt;&lt;- opcode: QUERY, status: NOERROR, id: 16481</span>
</span><span class='line'><span class="s">;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0</span>
</span><span class='line'>
</span><span class='line'><span class="s">;; QUESTION SECTION:</span>
</span><span class='line'><span class="s">;tingxueren.info.     IN  A</span>
</span><span class='line'>
</span><span class='line'><span class="s">;; ANSWER SECTION:</span>
</span><span class='line'><span class="s">tingxueren.info.  1800    IN  A   204.232.175.78</span>
</span><span class='line'>
</span><span class='line'><span class="s">;; Query time: 368 msec</span>
</span><span class='line'><span class="s">;; SERVER: 8.8.8.8#53(8.8.8.8)</span>
</span><span class='line'><span class="s">;; WHEN: Sat Nov 24 19:23:45 2012</span>
</span><span class='line'><span class="s">;; MSG SIZE  rcvd: 49</span>
</span><span class='line'><span class="s"># dig tingxueren.github.com</span>
</span><span class='line'><span class="s">dig @8.8.8.8 tingxueren.github.com</span>
</span><span class='line'>
</span><span class='line'><span class="s">; &lt;&lt;&gt;&gt; DiG 9.8.1-P1 &lt;&lt;&gt;&gt; @8.8.8.8 tingxueren.github.com</span>
</span><span class='line'><span class="s">; (1 server found)</span>
</span><span class='line'><span class="s">;; global options: +cmd</span>
</span><span class='line'><span class="s">;; Got answer:</span>
</span><span class='line'><span class="s">;; -&gt;&gt;HEADER&lt;&lt;- opcode</span>: QUERY, status: NOERROR, id: 51234
</span><span class='line'>;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0
</span><span class='line'>
</span><span class='line'>;; QUESTION SECTION:
</span><span class='line'>;tingxueren.github.com.       IN  A
</span><span class='line'>
</span><span class='line'>;; ANSWER SECTION:
</span><span class='line'>tingxueren.github.com.    43200   IN  A   204.232.175.78
</span><span class='line'>
</span><span class='line'>;; Query <span class="nb">time</span>: 180 msec
</span><span class='line'>;; SERVER: 8.8.8.8#53<span class="o">(</span>8.8.8.8<span class="o">)</span>
</span><span class='line'>;; WHEN: Sat Nov 24 19:26:58 2012
</span><span class='line'>;; MSG SIZE  rcvd: 55
</span></code></pre></td></tr></table></div></figure>


<h3>whois</h3>

<p><a href="http://zh.wikipedia.org/zh-cn/WHOIS">WHOIS</a>（读作“Who is”，而非缩写）是用来查询互联网中域名的IP以及所有者等信息的传输协议。上面才查找 twitter 的错误 ip 的时候已经用过了，现在把刚才信息贴出来。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>whois 59.24.3.173
</span><span class='line'><span class="c"># 韩文显示不正常，省略</span>
</span><span class='line'><span class="c"># ENGLISH</span>
</span><span class='line'>
</span><span class='line'>KRNIC is not an ISP but a National Internet Registry similar to APNIC.
</span><span class='line'>
</span><span class='line'><span class="o">[</span> Network Information <span class="o">]</span>
</span><span class='line'>IPv4 Address       : 59.0.0.0 - 59.31.255.255 <span class="o">(</span>/11<span class="o">)</span>
</span><span class='line'>Service Name       : KORNET
</span><span class='line'>Organization Name  : Korea Telecom
</span><span class='line'>Organization ID    : ORG1600
</span><span class='line'>Address            : 206, Jungja-dong, Bundang-gu, Sungnam-ci
</span><span class='line'>Zip Code           : 463-711
</span><span class='line'>Registration Date  : 20040831
</span><span class='line'>
</span><span class='line'><span class="o">[</span> Admin Contact Information <span class="o">]</span>
</span><span class='line'>Name               : IP Administrator
</span><span class='line'>Phone              : +82-2-500-6630
</span><span class='line'>E-Mail             : kornet_ip@kt.com
</span><span class='line'>
</span><span class='line'><span class="o">[</span> Tech Contact Information <span class="o">]</span>
</span><span class='line'>Name               : IP Manager
</span><span class='line'>Phone              : +82-2-500-6630
</span><span class='line'>E-Mail             : kornet_ip@kt.com
</span><span class='line'>
</span><span class='line'><span class="o">[</span> Network Abuse Contact Information <span class="o">]</span>
</span><span class='line'>Name               : Network Abuse
</span><span class='line'>Phone              : +82-2-100-0000
</span><span class='line'>E-Mail             : abuse@kornet.net
</span><span class='line'><span class="c"># GFW 常常会把 “非法网站” 进行 DNS 投毒，解析到韩国的 ip，韩国是躺着也中枪</span>
</span></code></pre></td></tr></table></div></figure>


<h3>iftop 和 ntop</h3>

<p>这两个工具是用来做流量监控的，iftop 比较简陋，提供的是字符界面，ntop 安装后可以在本机浏览器打开 3000 端口会有图形界面的，内容相当的详细。对这两个工具了解的不多，只是刚开始用，可以看下下面这两个帖子。
1. <a href="http://www.vpser.net/manage/iftop.html">Linux流量监控工具 &ndash; iftop (最全面的iftop教程)</a>
2. <a href="http://netslyz.blog.51cto.com/1006247/407510/">在RHEL5下使用NTOP监测网络流量</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2012-11-24T18:22:00+08:00" pubdate data-updated="true">Nov 24<span>th</span>, 2012</time></div>
	<div class="tags">

</div>
	
</div>
</article>

<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2014

    tingxueren

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'tingxueren';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-37023627-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>